var e=Object.defineProperty,s=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(s,a,t)=>a in s?e(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t,d=(e,s)=>{for(var a in s||(s={}))n.call(s,a)&&l(e,a,s[a]);if(t)for(var a of t(s))i.call(s,a)&&l(e,a,s[a]);return e},r=(e,t)=>s(e,a(t)),c=(e,s,a)=>new Promise((t,n)=>{var i=e=>{try{d(a.next(e))}catch(s){n(s)}},l=e=>{try{d(a.throw(e))}catch(s){n(s)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,l);d((a=a.apply(e,s)).next())});import{j as o,X as m,a0 as u,a as p,C as h,aa as x,ab as g}from"./ui-vendor-NJW5rtDU.js";import{M as y}from"./MediaUpload-DSeSwC9g.js";import{P as j,b as v,B as b,c as f,d as A,e as N,C as w,f as S,h as C,i as T,j as D,k as U,u as F,l as R,S as P,m as k,n as M,o as E,p as O,D as I,q as V,r as L,s as q,t as z,L as Y,I as H,v as B,T as G,w as K,x as W,y as _,z as J,A as Q,H as X,E as $,F as Z,G as ee,J as se,K as ae,M as te,N as ne,O as ie,Q as le,R as de,U as re,V as ce,W as oe,X as me,Y as ue}from"./index-DR4W6oDl.js";import{r as pe,e as he,u as xe}from"./react-vendor-7nhe2WMs.js";import{T as ge,a as ye,b as je,c as ve,d as be,e as fe}from"./table-BjDYCMyB.js";function Ae({options:e,selectedValues:s,onSelectionChange:a,placeholder:t="Select options...",className:n,disabled:i=!1}){const[l,d]=pe.useState(!1),[r,c]=pe.useState(""),h=pe.useMemo(()=>{if(!r)return e;const s=r.toLowerCase();return e.filter(e=>e.label.toLowerCase().includes(s)||e.value.toLowerCase().includes(s))},[e,r]),x=pe.useMemo(()=>e.filter(e=>s.includes(e.value)),[e,s]),g=(e,t)=>{t.preventDefault(),t.stopPropagation(),a(s.filter(s=>s!==e))};return o.jsxs(j,{open:l,onOpenChange:d,children:[o.jsx(v,{asChild:!0,children:o.jsxs(b,{variant:"outline",role:"combobox","aria-expanded":l,className:f("w-full justify-between min-h-[42px] h-auto",!s.length&&"text-muted-foreground",n),disabled:i,children:[o.jsx("div",{className:"flex flex-wrap gap-1 flex-1",children:0===x.length?o.jsx("span",{children:t}):x.map(e=>o.jsxs(A,{variant:"secondary",className:"mr-1 mb-1 cursor-pointer",onClick:s=>g(e.value,s),onMouseDown:e=>e.stopPropagation(),children:[e.label,o.jsx("span",{role:"button",tabIndex:0,className:"ml-1 rounded-full hover:bg-secondary-foreground/20 inline-flex items-center justify-center p-0.5",onClick:s=>g(e.value,s),onMouseDown:e=>e.stopPropagation(),onKeyDown:s=>{"Enter"!==s.key&&" "!==s.key||(s.preventDefault(),s.stopPropagation(),g(e.value,s))},children:o.jsx(m,{className:"h-3 w-3"})})]},e.value))}),o.jsx(u,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),o.jsx(N,{className:"w-[var(--radix-popover-trigger-width)] p-0",align:"start",children:o.jsxs(w,{children:[o.jsx(S,{placeholder:"Search...",value:r,onValueChange:c}),o.jsxs(C,{children:[o.jsx(T,{children:"No options found."}),o.jsx(D,{children:h.map(e=>{const t=s.includes(e.value);return o.jsxs(U,{value:e.value,onSelect:()=>{return t=e.value,void(s.includes(t)?a(s.filter(e=>e!==t)):a([...s,t]));var t},className:"cursor-pointer",children:[o.jsx(p,{className:f("mr-2 h-4 w-4",t?"opacity-100":"opacity-0")}),e.label]},e.value)})})]})]})})]})}const Ne=({label:e,id:s,selectedCities:a,placeholder:t,maxCities:n=10,onChange:i})=>{const{t:l}=F(),[d,r]=pe.useState(!1),[c,u]=pe.useState(""),[x,g]=pe.useState([]),[y,k]=pe.useState(!1),M=R(),E=he.useRef(null);pe.useEffect(()=>{var e,s;if("undefined"==typeof window)return;const a="AIzaSyAjx6NIRePitcFdZjH2kE0z-zSAy8etaUE",t=document.querySelectorAll('script[src*="maps.googleapis.com"]');let n=!1;if(t.forEach(e=>{e.src.includes("AIzaSyAwzQsbG0vO0JWzOs7UAyu0upW6Xc1KL4E")&&(e.remove(),n=!0)}),n&&delete window.google,null==(s=null==(e=window.google)?void 0:e.maps)?void 0:s.places){try{E.current=new window.google.maps.places.AutocompleteService,k(!0)}catch(l){}return}const i=document.querySelector("script[data-facepet-google]");if(i&&i.src.includes(a)){return void setTimeout(()=>{var e,s;if(null==(s=null==(e=window.google)?void 0:e.maps)?void 0:s.places)try{E.current=new window.google.maps.places.AutocompleteService,k(!0)}catch(l){}},0)}if(i&&!i.src.includes(a)&&(i.remove(),delete window.google),!document.querySelector("script[data-facepet-google]")){const e=document.createElement("script");e.src=`https://maps.googleapis.com/maps/api/js?key=${a}&libraries=places&language=${M}`,e.async=!0,e.defer=!0,e.setAttribute("data-facepet-google","true"),e.onload=()=>{try{E.current=new window.google.maps.places.AutocompleteService,k(!0)}catch(l){}},e.onerror=()=>{},document.head.appendChild(e)}},[M]),pe.useEffect(()=>{if(!y||!c)return void g([]);const e=E.current;if(!e)return;let s=!1;const a=requestAnimationFrame(()=>{e.getPlacePredictions({input:c,language:M,componentRestrictions:{country:"il"},types:["(cities)"]},e=>{s||g((e||[]).map(e=>({description:e.description,place_id:e.place_id})))})});return()=>{s=!0,cancelAnimationFrame(a)}},[c,y,M]);const O=a.length>=n;return o.jsxs("div",{className:"relative w-full space-y-2",children:[o.jsxs(j,{open:d,onOpenChange:r,children:[o.jsx(v,{asChild:!0,children:o.jsxs(b,{type:"button",variant:"outline",id:s,className:f("h-10 w-full justify-between border-gray-300 bg-white px-3 text-sm hover:bg-white",O&&"opacity-70"),onClick:()=>r(!0),disabled:O,children:[o.jsx("span",{className:"text-gray-400 font-normal",children:O?l("Admin.forms.addAd.citiesMaxReached",{max:n}):t||l("Admin.forms.addAd.citiesPlaceholder")}),o.jsxs("div",{className:"flex items-center gap-2",children:[a.length>0&&o.jsxs("span",{className:"text-xs text-gray-500",children:[a.length,"/",n]}),o.jsx(h,{className:"h-4 w-4 opacity-50 shrink-0"})]})]})}),o.jsx(N,{className:"w-[var(--radix-popover-trigger-width)] p-0",children:o.jsxs(w,{children:[o.jsx(S,{placeholder:l("components.searchbar.search"),value:c,onValueChange:u}),o.jsx(C,{children:x.length>0?o.jsx(P,{className:"max-h-44 overflow-y-auto",children:o.jsx(D,{children:x.map(e=>{const s=e.description.split(",")[0].trim(),t=a.includes(s);return o.jsxs(U,{value:e.description,onSelect:()=>(e=>{if(a.length>=n)return;const s=e.split(",")[0].trim();a.includes(s)||i([...a,s]),u("")})(e.description),disabled:t,children:[e.description,o.jsx("div",{className:"grow"}),o.jsx(p,{className:f("ml-auto",t?"opacity-100":"opacity-0"),size:16})]},e.place_id)})})}):o.jsx(T,{children:y?l(c?"components.searchbar.noResult":"Admin.forms.addAd.citiesSearchHint"):"Loading..."})})]})})]}),a.length>0&&o.jsx("div",{className:"flex flex-wrap gap-1",children:a.map(e=>o.jsxs(A,{variant:"secondary",className:"px-2 py-1 text-xs flex items-center gap-1",children:[e,o.jsx("button",{type:"button",onClick:()=>{return s=e,void i(a.filter(e=>e!==s));var s},className:"ml-1 hover:text-red-500",children:o.jsx(m,{className:"h-3 w-3"})})]},e))})]})};function we(){const{t:e}=F(),[s,a]=pe.useState(!1),t=R(),[n,i]=pe.useState("image"),[l,m]=pe.useState({title:"",content:"",youtubeUrl:"",phone:"",cities:[],description:"",tags:[],petType:"",breed:"",ageRange:[],weight:[]}),[u,p]=pe.useState(!1),[h,x]=pe.useState(null),[g,j]=pe.useState([]),[v,f]=pe.useState([]),[A,N]=pe.useState([]),[w,S]=pe.useState([]);xe(),pe.useEffect(()=>{s&&(C(),D(),U())},[s,t]),pe.useEffect(()=>{l.petType?T(l.petType):f([])},[l.petType]);const C=()=>c(null,null,function*(){const e=yield k(t);j(e)}),T=e=>c(null,null,function*(){const e=yield M(t);f(e)}),D=()=>c(null,null,function*(){const e=yield E(t);N(e)}),U=()=>c(null,null,function*(){const e=yield O(t);S(e)}),P=e=>{const{name:s,value:a}=e.target;m(e=>r(d({},e),{[s]:a}))};return o.jsxs(I,{open:s,onOpenChange:a,children:[o.jsx(V,{asChild:!0,children:o.jsx(b,{children:e("Admin.adsManagement.addNewAd")})}),o.jsxs(L,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[o.jsx(q,{children:o.jsx(z,{children:e("Admin.adsManagement.addNewAdvertisement")})}),h&&o.jsx("div",{className:"mb-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",children:h}),o.jsxs("form",{onSubmit:s=>c(null,null,function*(){s.preventDefault(),p(!0),x(null);try{let s="image",t=l.content;"youtube"===n?(s="video",t=l.youtubeUrl||""):"video"===n?(s="video",t=l.content):(s="image",t=l.content);const d=yield Z({title:l.title,type:s,content:t,duration:5,status:"active",startDate:null,endDate:null,phone:l.phone,city:l.cities,description:l.description,tags:l.tags,petType:l.petType,breed:l.breed,ageRange:l.ageRange,weight:l.weight});if(!d.success)return void x(d.error||e("Admin.forms.addAd.createError"));m({title:"",content:"",youtubeUrl:"",phone:"",cities:[],description:"",tags:[],petType:"",breed:"",ageRange:[],weight:[]}),i("image"),a(!1),window.location.reload()}catch(t){x(t.message||e("Admin.forms.addAd.createError"))}finally{p(!1)}}),className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"title",children:e("Admin.forms.addAd.title")}),o.jsx(H,{id:"title",name:"title",value:l.title,onChange:P,required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{children:e("Admin.forms.addAd.mediaType")||"Media Type"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"image",checked:"image"===n,onChange:e=>i(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:e("Admin.forms.addAd.image")||"Image"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"video",checked:"video"===n,onChange:e=>i(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:e("Admin.forms.addAd.video")||"Video"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"youtube",checked:"youtube"===n,onChange:e=>i(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:e("Admin.forms.addAd.youtube")||"YouTube"})]})]})]}),"youtube"===n?o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"youtubeUrl",children:e("Admin.forms.addAd.youtubeUrl")||"YouTube URL"}),o.jsx(H,{id:"youtubeUrl",name:"youtubeUrl",value:l.youtubeUrl,onChange:P,placeholder:"https://www.youtube.com/watch?v=...",type:"url",required:!0}),o.jsx("p",{className:"text-sm text-gray-500",children:e("Admin.forms.addAd.youtubeUrlHelp")||"Enter a YouTube video URL"}),l.youtubeUrl&&B(l.youtubeUrl)&&o.jsx("div",{className:"mt-4 rounded-md overflow-hidden border",children:o.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:o.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full",src:B(l.youtubeUrl)||"",title:"YouTube video preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}):o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"content",children:e("Admin.forms.addAd.content")}),o.jsx(y,{type:n,value:l.content,onChange:e=>{m(s=>r(d({},s),{content:e}))}})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"description",children:e("Admin.forms.addAd.description")}),o.jsx(G,{id:"description",name:"description",value:l.description,onChange:P,placeholder:e("Admin.forms.addAd.descriptionPlaceholder"),rows:3})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"phone",children:e("Admin.forms.addAd.phoneNumber")}),o.jsx(H,{id:"phone",name:"phone",value:l.phone,onChange:P,placeholder:e("Admin.forms.addAd.phonePlaceholder")})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"cities",children:e("Admin.forms.addAd.cities")}),o.jsx(Ne,{id:"cities",selectedCities:l.cities,onChange:e=>{m(s=>r(d({},s),{cities:e}))},placeholder:e("Admin.forms.addAd.citiesPlaceholder")})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"petType",children:e("Admin.forms.addAd.petType")}),o.jsxs(K,{value:l.petType,onValueChange:e=>{m(s=>r(d({},s),{petType:e,breed:""}))},children:[o.jsx(W,{children:o.jsx(_,{placeholder:e("Admin.forms.addAd.petTypePlaceholder")})}),o.jsx(J,{children:g.map(e=>o.jsx(Q,{value:e.value,children:e.label},e.value))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"breed",children:e("Admin.forms.addAd.breed")}),o.jsxs(K,{value:l.breed,onValueChange:e=>{m(s=>r(d({},s),{breed:e}))},disabled:!l.petType,children:[o.jsx(W,{children:o.jsx(_,{placeholder:e("Admin.forms.addAd.breedPlaceholder")})}),o.jsx(J,{children:v.map(e=>o.jsx(Q,{value:e.value,children:e.label},e.value))})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"ageRange",children:e("Admin.forms.addAd.ageRange")}),o.jsx(Ae,{options:A,selectedValues:l.ageRange,onSelectionChange:e=>{m(s=>r(d({},s),{ageRange:e}))},placeholder:e("Admin.forms.addAd.ageRangePlaceholder")})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"weight",children:e("Admin.forms.addAd.weight")}),o.jsx(Ae,{options:w,selectedValues:l.weight,onSelectionChange:e=>{m(s=>r(d({},s),{weight:e}))},placeholder:e("Admin.forms.addAd.weightPlaceholder")})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"tags",children:e("Admin.adActions.tags")}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{className:"text-sm font-medium text-gray-600",children:e("common.serviceTags")}),o.jsx("div",{className:"flex flex-wrap gap-2",children:X.map((e,s)=>o.jsx("button",{type:"button",onClick:()=>(e=>{l.tags.includes(e)||m(s=>r(d({},s),{tags:[...s.tags,e]}))})(e),disabled:l.tags.includes(e),className:"px-3 py-1 rounded-full text-sm border transition-colors "+(l.tags.includes(e)?"bg-primary text-primary-foreground border-primary":"bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200"),children:e},s))})]}),l.tags.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{className:"text-sm font-medium text-gray-600",children:e("common.selectedTags")}),o.jsx("div",{className:"flex flex-wrap gap-2",children:l.tags.map((e,s)=>o.jsxs("span",{className:"bg-primary text-primary-foreground px-2 py-1 rounded text-sm flex items-center gap-1",children:[e,o.jsx("button",{type:"button",onClick:()=>{return s=e,void m(e=>r(d({},e),{tags:e.tags.filter(e=>e!==s)}));var s},className:"ml-1 hover:text-red-300",children:"×"})]},s))})]})]}),o.jsxs($,{children:[o.jsx(b,{type:"button",variant:"outline",onClick:()=>a(!1),children:e("Admin.common.cancel")}),o.jsx(b,{type:"submit",disabled:u,children:e(u?"Admin.forms.addAd.creating":"Admin.forms.addAd.createAd")})]})]})]})]})}function Se({ad:e,onDelete:s,onUpdate:a}){const{t:t}=F(),n=R(),[i,l]=pe.useState(!1),[m,u]=pe.useState(!1),[p,h]=pe.useState(!1),[j,v]=pe.useState(!1),[f,A]=pe.useState(!1),[N,w]=pe.useState(null),[S,C]=pe.useState([]),[T,D]=pe.useState([]),[U,P]=pe.useState([]),[E,O]=pe.useState([]),V=e=>!!e&&(e.includes("youtube.com")||e.includes("youtu.be")||null!==de(e)),[Z,ue]=pe.useState(()=>V(e.content)?"youtube":"video"===e.type?"video":"image"),he=e=>Array.isArray(e)?e[0]||"":e||"",[xe,ge]=pe.useState({title:e.title,content:V(e.content)?"":e.content,youtubeUrl:V(e.content)?e.content:"",type:e.type,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?new Date(e.endDate).toISOString().split("T")[0]:"",phone:e.phone||"",description:e.description||"",tags:e.tags||[],city:e.city||[],petType:he(e.petType),breed:he(e.breed),ageRange:e.ageRange||[],weight:e.weight||[]});pe.useEffect(()=>{m&&ye()},[m]),pe.useEffect(()=>{xe.petType?je(xe.petType):D([])},[xe.petType]),pe.useEffect(()=>{if(m&&e){const s=V(e.content);ue(s?"youtube":"video"===e.type?"video":"image"),ge({title:e.title,content:s?"":e.content,youtubeUrl:s?e.content:"",type:e.type,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?new Date(e.endDate).toISOString().split("T")[0]:"",phone:e.phone||"",description:e.description||"",tags:e.tags||[],city:e.city||[],petType:he(e.petType),breed:he(e.breed),ageRange:e.ageRange||[],weight:e.weight||[]})}},[m,e]);const ye=()=>c(null,null,function*(){const e=yield k(n);C(e)}),je=e=>c(null,null,function*(){const e=yield M(n);D(e)}),ve=e=>{const{name:s,value:a}=e.target;ge(e=>r(d({},e),{[s]:a}))};return o.jsxs("div",{className:"relative",children:[o.jsxs(ee,{children:[o.jsx(se,{asChild:!0,children:o.jsxs(b,{variant:"ghost",size:"icon",className:"h-8 w-8 p-0",children:[o.jsx(x,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:t("Admin.adActions.actions")})]})}),o.jsxs(ae,{align:"end",children:[o.jsx(te,{children:t("Admin.adActions.actions")}),o.jsx(ne,{onClick:()=>u(!0),children:t("Admin.adActions.edit")}),o.jsxs(ne,{onClick:()=>c(null,null,function*(){l(!0);try{const s=yield oe(e.id);s.success?(me.success(t("Admin.adActions.duplicateSuccess")),a?a():window.location.reload()):me.error(s.error||t("Admin.adActions.duplicateError"))}catch(s){me.error(s.message||t("Admin.adActions.duplicateError"))}finally{l(!1)}}),disabled:i,children:[o.jsx(g,{className:"h-4 w-4 me-2"}),t(i?"Admin.adActions.duplicating":"Admin.adActions.duplicate")]}),o.jsx(ie,{}),o.jsx(ne,{onClick:()=>h(!0),className:"text-red-600 hover:text-red-700 focus:text-red-700",children:t("Admin.adActions.delete")})]})]}),o.jsx(I,{open:m,onOpenChange:s=>{if(!s){const s=V(e.content);ue(s?"youtube":"video"===e.type?"video":"image"),ge({title:e.title,content:s?"":e.content,youtubeUrl:s?e.content:"",type:e.type,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",endDate:e.endDate?new Date(e.endDate).toISOString().split("T")[0]:"",phone:e.phone||"",description:e.description||"",tags:e.tags||[],city:e.city||[],petType:e.petType||"",breed:e.breed||"",ageRange:e.ageRange||[],weight:e.weight||[]}),w(null)}u(s)},children:o.jsxs(L,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[o.jsx(q,{children:o.jsx(z,{children:t("Admin.adActions.edit")})}),N&&o.jsx("div",{className:"mb-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",children:N}),o.jsxs("form",{onSubmit:s=>c(null,null,function*(){s.preventDefault(),A(!0),w(null);try{let s="image",t=xe.content;"youtube"===Z?(s="video",t=xe.youtubeUrl||""):"video"===Z?(s="video",t=xe.content):(s="image",t=xe.content);yield re(e.id,{title:xe.title,content:t,type:s,status:"active",startDate:null,endDate:null,phone:xe.phone,description:xe.description,tags:xe.tags,city:xe.city,petType:xe.petType,breed:xe.breed,ageRange:xe.ageRange,weight:xe.weight});u(!1),a?a():window.location.reload()}catch(t){w(t.message||"Failed to update advertisement")}finally{A(!1)}}),className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"title",children:t("Admin.adActions.title")}),o.jsx(H,{id:"title",name:"title",value:xe.title,onChange:ve,required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"description",children:t("Admin.adActions.description")}),o.jsx(G,{id:"description",name:"description",value:xe.description,onChange:ve,placeholder:t("Admin.adActions.descriptionPlaceholder"),rows:3})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"phone",children:t("Admin.adActions.phoneNumber")}),o.jsx(H,{id:"phone",name:"phone",value:xe.phone,onChange:ve,placeholder:t("Admin.adActions.phonePlaceholder")})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"city",children:t("Admin.adActions.cities")}),o.jsx(Ne,{id:"city",selectedCities:xe.city,onChange:e=>{ge(s=>r(d({},s),{city:e}))},placeholder:t("Admin.adActions.citiesPlaceholder")})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"petType",children:t("Admin.adActions.petType")}),o.jsxs(K,{value:xe.petType,onValueChange:e=>{ge(s=>r(d({},s),{petType:e,breed:""}))},children:[o.jsx(W,{children:o.jsx(_,{placeholder:t("Admin.adActions.petTypePlaceholder")})}),o.jsx(J,{children:S.map(e=>o.jsx(Q,{value:e.value,children:e.label},e.value))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"breed",children:t("Admin.adActions.breed")}),o.jsxs(K,{value:xe.breed,onValueChange:e=>{ge(s=>r(d({},s),{breed:e}))},disabled:!xe.petType,children:[o.jsx(W,{children:o.jsx(_,{placeholder:t("Admin.adActions.breedPlaceholder")})}),o.jsx(J,{children:T.map(e=>o.jsx(Q,{value:e.value,children:e.label},e.value))})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"ageRange",children:t("Admin.adActions.ageRange")}),o.jsx(Ae,{options:U,selectedValues:xe.ageRange,onSelectionChange:e=>{ge(s=>r(d({},s),{ageRange:e}))},placeholder:t("Admin.adActions.ageRangePlaceholder")})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"weight",children:t("Admin.adActions.weight")}),o.jsx(Ae,{options:E,selectedValues:xe.weight,onSelectionChange:e=>{ge(s=>r(d({},s),{weight:e}))},placeholder:t("Admin.adActions.weightPlaceholder")})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"tags",children:t("Admin.adActions.tags")}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{className:"text-sm font-medium text-gray-600",children:t("common.serviceTags")}),o.jsx("div",{className:"flex flex-wrap gap-2",children:X.map((e,s)=>o.jsx("button",{type:"button",onClick:()=>(e=>{xe.tags.includes(e)||ge(s=>r(d({},s),{tags:[...s.tags,e]}))})(e),disabled:xe.tags.includes(e),className:"px-3 py-1 rounded-full text-sm border transition-colors "+(xe.tags.includes(e)?"bg-primary text-primary-foreground border-primary":"bg-gray-100 text-gray-700 border-gray-300 hover:bg-gray-200"),children:e},s))})]}),xe.tags.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{className:"text-sm font-medium text-gray-600",children:t("common.selectedTags")}),o.jsx("div",{className:"flex flex-wrap gap-2",children:xe.tags.map((e,s)=>o.jsxs("span",{className:"bg-primary text-primary-foreground px-2 py-1 rounded text-sm flex items-center gap-1",children:[e,o.jsx("button",{type:"button",onClick:()=>{return s=e,void ge(e=>r(d({},e),{tags:e.tags.filter(e=>e!==s)}));var s},className:"ml-1 hover:text-red-300",children:"×"})]},s))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{children:t("Admin.adActions.mediaType")||"Media Type"}),o.jsxs("div",{className:"flex gap-4",children:[o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"image",checked:"image"===Z,onChange:e=>ue(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:t("Admin.adActions.image")||"Image"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"video",checked:"video"===Z,onChange:e=>ue(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:t("Admin.adActions.video")||"Video"})]}),o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"radio",value:"youtube",checked:"youtube"===Z,onChange:e=>ue(e.target.value),className:"cursor-pointer"}),o.jsx("span",{children:t("Admin.adActions.youtube")||"YouTube"})]})]})]}),"youtube"===Z?o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"youtubeUrl",children:t("Admin.adActions.youtubeUrl")||"YouTube URL"}),o.jsx(H,{id:"youtubeUrl",name:"youtubeUrl",value:xe.youtubeUrl,onChange:ve,placeholder:"https://www.youtube.com/watch?v=...",type:"url",required:!0}),o.jsx("p",{className:"text-sm text-gray-500",children:t("Admin.adActions.youtubeUrlHelp")||"Enter a YouTube video URL"}),xe.youtubeUrl&&B(xe.youtubeUrl)&&o.jsx("div",{className:"mt-4 rounded-md overflow-hidden border",children:o.jsx("div",{className:"relative w-full",style:{paddingBottom:"56.25%"},children:o.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full",src:B(xe.youtubeUrl)||"",title:"YouTube video preview",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}):o.jsxs("div",{className:"space-y-2",children:[o.jsx(Y,{htmlFor:"content",children:t("Admin.adActions.content")}),o.jsx(y,{type:Z,value:xe.content,onChange:e=>{ge(s=>r(d({},s),{content:e}))}})]}),o.jsxs($,{children:[o.jsx(b,{type:"button",variant:"outline",onClick:()=>u(!1),children:t("Admin.adActions.cancel")}),o.jsx(b,{type:"submit",disabled:f,children:t(f?"Admin.adActions.updating":"Admin.adActions.updateAd")})]})]})]})}),o.jsx(I,{open:p,onOpenChange:e=>{e||(v(!1),w(null)),h(e)},children:o.jsxs(L,{className:"sm:max-w-md",children:[o.jsxs(q,{children:[o.jsx(z,{children:t("Admin.adActions.confirmDeletion")}),o.jsx(le,{children:t("Admin.adActions.deleteMessage")})]}),N&&o.jsx("div",{className:"mb-4 rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700",children:N}),o.jsxs($,{children:[o.jsx(b,{variant:"outline",onClick:()=>h(!1),children:t("Admin.adActions.cancel")}),o.jsx(b,{variant:"destructive",onClick:()=>{v(!0),c(null,null,function*(){if(j){A(!0),w(null);try{yield ce(e.id),h(!1),s?s():window.location.reload()}catch(a){w(a.message||"Failed to delete advertisement")}finally{A(!1)}}else h(!0)})},disabled:f,children:t(f?"Admin.adActions.deleting":"Admin.adActions.deleteAd")})]})]})})]})}function Ce(){const{t:e}=F(),s=R(),[a,t]=pe.useState([]),[n,i]=pe.useState(!0),[l,d]=pe.useState(null),[r,m]=pe.useState({});pe.useEffect(()=>{p(),u()},[s]);const u=()=>c(null,null,function*(){const e=yield k(s),a={};e.forEach(e=>{a[e.value]=e.label}),m(a)}),p=()=>c(null,null,function*(){try{i(!0);const e=yield ue(0,1e3);e.ads?t(e.ads):d("Failed to fetch ads")}catch(e){d("Failed to fetch ads")}finally{i(!1)}}),h=e=>{const s="string"==typeof e?new Date(e):e;return new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(s)},x=s=>{const a={active:{label:e("Admin.adsManagement.status.active"),className:"bg-green-100 text-green-800"},scheduled:{label:e("Admin.adsManagement.status.scheduled"),className:"bg-yellow-100 text-yellow-800"},draft:{label:e("Admin.adsManagement.status.draft"),className:"bg-gray-100 text-gray-800"},inactive:{label:e("Admin.adsManagement.status.inactive"),className:"bg-red-100 text-red-800"}},t=a[s]||a.draft;return o.jsx(A,{className:t.className,children:t.label})};return n?o.jsx("div",{className:"flex items-center justify-center p-8",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),o.jsx("p",{className:"text-gray-500",children:e("Admin.loading")})]})}):l?o.jsx("div",{className:"p-4 rounded border border-red-400 bg-red-100 text-red-700",children:l}):o.jsx("div",{className:"space-y-4",children:o.jsx("div",{className:"rounded-md border",children:o.jsxs(ge,{children:[o.jsx(ye,{children:o.jsxs(je,{children:[o.jsx(ve,{children:e("Admin.adsManagement.table.title")}),o.jsx(ve,{children:e("Admin.adsManagement.table.type")}),o.jsx(ve,{children:e("Admin.adsManagement.table.image")}),o.jsx(ve,{children:e("Admin.adsManagement.table.cities")}),o.jsx(ve,{children:e("Admin.adsManagement.table.petType")}),o.jsx(ve,{children:e("Admin.adsManagement.table.status")}),o.jsx(ve,{children:e("Admin.adsManagement.table.created")}),o.jsx(ve,{className:"w-[50px]"})]})}),o.jsx(be,{children:0===a.length?o.jsx(je,{children:o.jsx(fe,{colSpan:8,className:"text-center py-8 text-gray-500",children:e("Admin.adsManagement.table.noAds")})}):a.map(e=>o.jsxs(je,{children:[o.jsx(fe,{className:"font-medium",children:e.title}),o.jsx(fe,{children:o.jsx(A,{variant:"outline",children:e.type})}),o.jsx(fe,{children:e.content?o.jsx("div",{className:"w-16 h-10 rounded-md overflow-hidden",children:o.jsx("img",{src:e.content,alt:e.title,className:"w-full h-full object-cover"})}):o.jsx("div",{className:"w-16 h-10 rounded-md bg-gray-100 flex items-center justify-center",children:o.jsx("span",{className:"text-xs text-gray-400",children:"No Image"})})}),o.jsx(fe,{children:e.city&&e.city.length>0?o.jsxs("div",{className:"flex flex-wrap gap-1 max-w-[150px]",children:[e.city.slice(0,2).map((e,s)=>o.jsx(A,{variant:"secondary",className:"text-xs",children:e},s)),e.city.length>2&&o.jsxs(A,{variant:"outline",className:"text-xs",children:["+",e.city.length-2]})]}):o.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),o.jsx(fe,{children:e.petType?o.jsx(A,{variant:"outline",children:r[e.petType]||e.petType}):o.jsx("span",{className:"text-xs text-gray-400",children:"-"})}),o.jsx(fe,{children:x(e.status)}),o.jsx(fe,{children:h(e.createdAt)}),o.jsx(fe,{children:o.jsx(Se,{ad:e,onDelete:p,onUpdate:p})})]},e.id))})]})})})}function Te({searchParams:e}){const{t:s}=F();return o.jsx("div",{className:"container mx-auto p-4 md:p-8",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[o.jsxs("div",{className:"text-start order-last md:order-first",children:[o.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 text-start",children:s("Admin.adsManagement.title")}),o.jsx("p",{className:"text-gray-600 mt-2 text-sm md:text-base text-start",children:s("Admin.adsManagement.description")})]}),o.jsx("div",{className:"order-first md:order-last",children:o.jsx(we,{})})]}),o.jsx(Ce,{})]})})}export{Te as default};
